<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Index - Books</title>
  <style>
    .grid{display:flex;flex-wrap:wrap}
    .card{width:16%;padding:10px;border:1px solid #ddd;margin:8px;box-sizing:border-box}
    .card img{width:100%;height:100px;object-fit:cover}
    button{margin-top:6px}
  </style>
</head>
<body>
  <h2>Books Index</h2>
  <div>
    <a href="insert.html">Insert Book</a> |
    <a href="delete.html">Delete Book</a> |
    <a href="search_update.html">Search & Update</a> |
    <a href="buy.html">Buy</a>
  </div>
  <div id="grid" class="grid"></div>

  <script>
    async function load(){
      const res = await fetch('/books');
      const books = await res.json();
      const grid = document.getElementById('grid'); grid.innerHTML='';
      books.forEach(b=>{
        const div = document.createElement('div'); div.className='card';
        div.innerHTML = `<div style="background:#ffc107;padding:6px;text-align:center;font-weight:bold">${b.itemname}</div>
        <img src="${b.image||''}" alt="">
        <div>${b.description}</div>
        <div>Price: ${b.price}</div>
        <div>
          <button onclick="del(${b.id})">Delete</button>
          <button onclick="goUpdate(${b.id})">Edit</button>
        </div>`;
        grid.appendChild(div);
      })
    }

    async function del(id){
      if (!confirm('Delete?')) return;
      await fetch('/books/'+id,{method:'DELETE'});
      load();
    }

    function goUpdate(id){
      window.location = 'search_update.html?id='+id;
    }


    load();
  </script>
</body>
</html>